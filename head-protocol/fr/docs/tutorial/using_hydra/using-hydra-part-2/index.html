<!doctype html>
<html class="docs-version-current" lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/head-protocol/fr/adr/rss.xml" title="Hydra: Head Protocol RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/head-protocol/fr/adr/atom.xml" title="Hydra: Head Protocol Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hydra: Head Protocol" href="/head-protocol/fr/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/head-protocol/fr/monthly/rss.xml" title="Hydra: Head Protocol RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/head-protocol/fr/monthly/atom.xml" title="Hydra: Head Protocol Atom Feed">
<script src="https://plausible.io/js/script.js" defer="defer" data-domain="hydra.family"></script><title data-rh="true">Setup | Hydra: Head Protocol</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://input-output-hk.github.io/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-2"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Setup | Hydra: Head Protocol"><meta data-rh="true" name="description" content="To showcase the protocol, we consider a minimal setup of two participants that together want to open a hydra head, call these two Bob and Alice. To start, we enter a nix-shell in the hydra repo and create a directory to hold some setup files."><meta data-rh="true" property="og:description" content="To showcase the protocol, we consider a minimal setup of two participants that together want to open a hydra head, call these two Bob and Alice. To start, we enter a nix-shell in the hydra repo and create a directory to hold some setup files."><link data-rh="true" rel="icon" href="/head-protocol/fr/img/hydra.png"><link data-rh="true" rel="canonical" href="https://input-output-hk.github.io/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-2"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/docs/tutorial/using_hydra/using-hydra-part-2" hreflang="en"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-2" hreflang="fr"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/ja/docs/tutorial/using_hydra/using-hydra-part-2" hreflang="ja"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/head-protocol/docs/tutorial/using_hydra/using-hydra-part-2" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://YZTAF8IOVB-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/head-protocol/fr/assets/css/styles.44efd72d.css">
<link rel="preload" href="/head-protocol/fr/assets/js/runtime~main.3719fd94.js" as="script">
<link rel="preload" href="/head-protocol/fr/assets/js/main.226af0dd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Aller au contenu principal</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/head-protocol/fr/"><div class="navbar__logo"><img src="/head-protocol/fr/img/hydra.png" alt="Hydra: Head Protocol" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/head-protocol/fr/img/hydra-white.png" alt="Hydra: Head Protocol" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Hydra: Head Protocol</b></a><a class="navbar__item navbar__link" href="/head-protocol/fr/docs/getting-started">Manuel Utilisateur</a><a class="navbar__item navbar__link" href="/head-protocol/fr/use-cases">Cas d&#x27;usages</a><a class="navbar__item navbar__link" href="/head-protocol/fr/core-concepts">Concepts cl√©s</a><a class="navbar__item navbar__link" href="/head-protocol/fr/topologies">Topologies</a><a class="navbar__item navbar__link" href="/head-protocol/fr/benchmarks">Benchmarks</a><a class="navbar__item navbar__link" href="/head-protocol/fr/api-reference">R√©f√©rence d&#x27;API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/input-output-hk/hydra" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>Fran√ßais</span></span></a><ul class="dropdown__menu"><li><a href="/head-protocol/docs/tutorial/using_hydra/using-hydra-part-2" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-2" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">Fran√ßais</a></li><li><a href="/head-protocol/ja/docs/tutorial/using_hydra/using-hydra-part-2" target="_self" rel="noopener noreferrer" class="dropdown__link">Êó•Êú¨Ë™û</a></li></ul></div><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Basculer entre th√®me clair ou sombre (theme actuel: Th√®me clair)"></div><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Chercher"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Chercher</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Revenez en haut" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/head-protocol/fr/docs/getting-started/">Prise en main</a><button aria-label="Ouvrir/Fermer la cat√©gorie &#x27;Prise en main&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/head-protocol/fr/docs/tutorial/">Tutorial</a><button aria-label="Ouvrir/Fermer la cat√©gorie &#x27;Tutorial&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/head-protocol/fr/docs/tutorial/intro">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/head-protocol/fr/docs/tutorial/protocol-outline">Protocol outline</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-1">Using Hydra</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-1">Preliminaries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-2">Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-3">Running</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/head-protocol/fr/docs/haskell_packages">Biblioth√®ques Haskell</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/head-protocol/fr/">üè†</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/head-protocol/fr/docs/tutorial/">Tutorial</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">Using Hydra</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-2">Setup</a></li></ul></nav><div class="theme-doc-markdown markdown"><h1>Setup</h1><p>To showcase the protocol, we consider a minimal setup of two participants that together want to open a hydra head, call these two Bob and Alice. To start, we enter a nix-shell in the <code>hydra</code> repo and create a directory to hold some setup files.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir test-head</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir test-head/Bob</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir test-head/Alice</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>Then we create for both participants a Cardano key pair and calculate its associated address. We do this with</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli address key-gen --verification-key-file test-head/Bob/BobCardano.vk --signing-key-file test-head/Bob/BobCardano.sk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli address build --payment-verification-key-file test-head/Bob/BobCardano.vk --testnet-magic 2 --out-file test-head/Bob/BobCardano.addr</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>and</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli address key-gen --verification-key-file test-head/Alice/AliceCardano.vk --signing-key-file test-head/Alice/AliceCardano.sk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli address build --payment-verification-key-file test-head/Alice/AliceCardano.vk --testnet-magic 2 --out-file test-head/Alice/AliceCardano.addr</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>Next we fund the wallets of Alice </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cat ./test-head/Alice/AliceCardano.addr</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>via the preview testnet <a href="https://docs.cardano.org/cardano-testnet/tools/faucet" target="_blank" rel="noopener noreferrer">faucet</a>. You can check the balance of this address via</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli query utxo --testnet-magic 2 --address $(cat ./test-head/Alice/AliceCardano.addr)</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>We can use the following script to split these funds with the wallet of Bob.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fullInput=$(cardano-cli query utxo --testnet-magic 2 --address $(cat ./test-head/Alice/AliceCardano.addr) | tail -n 1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inputTxRef=$(echo $fullInput | awk &#x27;{print $1}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inputTxId=$(echo $fullInput | awk &#x27;{print $2}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inputValue=$(echo $fullInput | awk &#x27;{print $3}&#x27;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli transaction build --babbage-era --testnet-magic 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --tx-in $inputTxRef#$inputTxId \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --tx-out $(cat ./test-head/Bob/BobCardano.addr)+$(($inputValue / 2))\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --change-address $(cat ./test-head/Alice/AliceCardano.addr) \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --out-file ./test-head/splitTx.tx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli transaction sign --testnet-magic 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        --signing-key-file ./test-head/Alice/AliceCardano.sk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        --tx-body-file ./test-head/splitTx.tx \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        --out-file ./test-head/splitTx.signed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm ./test-head/splitTx.tx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli transaction submit --testnet-magic 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --tx-file ./test-head/splitTx.signed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rm ./test-head/splitTx.signed</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>We can check the balance of both addresses with</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli query utxo --address $(cat ./test-head/Alice/AliceCardano.addr) --testnet-magic 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cardano-cli query utxo --address $(cat ./test-head/Bob/BobCardano.addr) --testnet-magic 2</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>Next we will mark some funds at each address so that the hydra-node can use these to pay for the hydra transactions and make sure that these are not committed in the head. Besides preventing having no funds left to close the head or contest to a false checkpoint, it also acts as the fuel for other stages of the protocol. These commands and script will make an output with a specific datum that the hydra node recognizes as fuel. Before we use the script make sure that <code>jq</code> is in your path, if not use</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">nix-shell -p jq</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>Then, to execute the script use</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">export CCLI_CMD=$(which cardano-cli)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./sample-node-config/gcp/scripts/fuel-testnet.sh ./preview-testnet/ ./test-head/Alice/AliceCardano.sk 4900000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./sample-node-config/gcp/scripts/fuel-testnet.sh ./preview-testnet/ ./test-head/Bob/BobCardano.sk 4900000000</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>This will mark about 100 ada as fuel for transactions hydra related. The other funds can be committed to the head.</p><p>Now we are going to set up the Hydra keys for the two parties. We can do this via the <code>hydra-tool</code> executable. Before we use this, we build this tool along with the <code>hydra-node</code> package with </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cabal build hydra-tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cabal build hydra-node</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>This can take some time. After this is done, we create two aliases that access these two binaries (you can also add an export to your <code>.bashrc</code> file)</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">alias hydra-tools=full/path/to/dist-newstyle/build/x86_64-linux/ghc-8.10.7/hydra-node-0.8.0/x/hydra-tools/build/hydra-tools/hydra-tools</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">alias hydra-node=full/path/to/dist-newstyle/build/x86_64-linux/ghc-8.10.7/hydra-node-0.8.0/x/hydra-node/build/hydra-node/hydra-node</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>to make them locally available. Alternatively, you can download the prebuilt binaries via this <a href="https://github.com/input-output-hk/hydra-poc/releases/tag/0.8.0" target="_blank" rel="noopener noreferrer">link</a>. Then we can use</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hydra-tools gen-hydra-key --output-file ./test-head/Alice/AliceHydra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hydra-tools gen-hydra-key --output-file ./test-head/Bob/BobHydra</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>We see the creation of the files <code>AliceHydra.sk</code> and  <code>AliceHydra.vk</code> (similar for Bob). These are the cryptographic key pairs that sign each snapshot for Alice and Bob. </p><p>We still need one thing, before we spin up the two hydra-nodes, that is the protocol parameter that we will use in our test head. We will use the protocol parameters that are the same on the testnet, but with a small tweak that there are no fees! Copy these settings from the <code>hydra</code> directory with</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">cp hydra-cluster/config/protocol-parameters.json ./test-head/protocol-parameters.json</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>Next we assign Alice the localhost address <code>127.0.0.1:5001</code> and Bob <code>127.0.0.1:5002</code>. As stated in the protocol outline, we need these four things to initiate the communication of a head</p><ul><li>An IP address + port of their machine that will run the Hydra node.</li><li>A Hydra verification key to identify them in the head.</li><li>A Cardano verification key to identify them on the blockchain.</li><li>The protocol parameters that they want to use in the Hydra head. </li></ul><p>Which we have set up above, now we can start a hydra node for each party.</p><p>Now we open two terminals and enter a nix-shell for each from the <code>hydra</code> directory, and reassign the aliases as above for the <code>hydra-node</code>. Before we launch the node, we first change directory to `test-head/Alice. We do this such that each node (that of Alice or Bob) does not interfere with the other. The node might produce some temporary files, so it is good practice to keep nodes separated at run time. After that, we launch a hydra-node for Alice with </p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hydra-node \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --node-id 1 --port 5001 --api-port 4001 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --peer 127.0.0.1:5002 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --hydra-signing-key AliceHydra.sk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --hydra-verification-key ../Bob/BobHydra.vk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --hydra-scripts-tx-id 4081fab39728fa3c05c0edc4dc7c0e8c45129ca6b2b70bf8600c1203a79d2c6d \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cardano-signing-key AliceCardano.sk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cardano-verification-key ../Bob/BobCardano.vk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --ledger-genesis ../../preview-testnet/shelley-genesis.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --ledger-protocol-parameters ../protocol-parameters.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --network-id 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --node-socket ../../preview-testnet/node.socket</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>Similarly, we change directories to `test-head/Bob and execute for Bob</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">hydra-node \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --node-id 2 --port 5002 --api-port 4002 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --peer 127.0.0.1:5001 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --hydra-signing-key BobHydra.sk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --hydra-verification-key ../Alice/AliceHydra.vk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --hydra-scripts-tx-id 4081fab39728fa3c05c0edc4dc7c0e8c45129ca6b2b70bf8600c1203a79d2c6d \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cardano-signing-key BobCardano.sk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --cardano-verification-key ../Alice/AliceCardano.vk \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --ledger-genesis ../../preview-testnet/shelley-genesis.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --ledger-protocol-parameters ../protocol-parameters.json \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --network-id 2 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --node-socket ../../preview-testnet/node.socket</span><br></span></code></pre><button type="button" aria-label="Copier le code" class="copyButton_wuS7 clean-btn">Copier</button></div></div><p>Here a few things stand out, first we see that each party adds the other as a <code>--peer</code>. Secondly, each party adds its own Cardano and Hydra signing key and peers Cardano and Hydra verification key. We also see that each node opens a local API for that party to communicate with its own node (using the <code>--api-port</code> flag). Lastly, we see the flag <code>--hydra-scripts-tx-id</code> followed by a hash. This is a transaction hash on the preview network that contains the hydra protocol scripts in its outputs. This way, we can reference these in our transactions to save on fees when making onchain transactions.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/input-output-hk/hydra/tree/master/docs/docs/tutorial/using_hydra/using-hydra-part-2.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>√âditer cette page</a></div><div class="col lastUpdated_itvN"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Pagination des documents"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-1"><div class="pagination-nav__sublabel">Pr√©c√©dent</div><div class="pagination-nav__label">Preliminaries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/head-protocol/fr/docs/tutorial/using_hydra/using-hydra-part-3"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">Running</div></a></div></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Contribuer</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/input-output-hk/hydra/wiki/Coding-Standards" target="_blank" rel="noopener noreferrer" class="footer__link-item">Conventions de programmation</a></li><li class="footer__item"><a class="footer__link-item" href="/head-protocol/fr/adr">D√©cisions Architecturales</a></li><li class="footer__item"><a href="https://github.com/input-output-hk/hydra/wiki/Testing-Strategy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contr√¥le qualit√©</a></li></ul></div><div class="col footer__col"><div class="footer__title">Communaut√©</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/Qq5vNTg9PT" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord (#ask-hydra)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/input-output-hk/hydra/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://cardano.stackexchange.com/questions/tagged/hydra" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Exchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Divers</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/head-protocol/fr/docs/haskell_packages">Biblioth√®ques Haskell</a></li><li class="footer__item"><a class="footer__link-item" href="/head-protocol/fr/monthly">Monthly reports</a></li><li class="footer__item"><a href="https://github.com/input-output-hk/hydra/wiki/Logbook" target="_blank" rel="noopener noreferrer" class="footer__link-item">Journal de bord</a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://static.iohk.io/terms/iohktermsandconditions.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms &amp; Conditions</a></li><li class="footer__item"><a href="https://static.iohk.io/terms/iog-privacy-policy.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://github.com/input-output-hk/hydra/graphs/contributors" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contributors</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 <strong>Input Output</strong> <br> <small>Site r√©alis√© avec Docusaurus</small></div></div></div></footer></div>
<script src="/head-protocol/fr/assets/js/runtime~main.3719fd94.js"></script>
<script src="/head-protocol/fr/assets/js/main.226af0dd.js"></script>
</body>
</html>